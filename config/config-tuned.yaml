# Tuned Typosentinel Configuration for Enhanced Typosquatting Detection
# Based on comprehensive test results and analysis

# Core Configuration
core:
  log_level: "info"
  max_workers: 10
  timeout: "30m"
  cache_enabled: true
  cache_ttl: "24h"

# Logging configuration
logging:
  level: "info"
  format: "text"
  output: "stdout"
  timestamp: true
  caller: false
  prefix: "[TYPOSENTINEL]"
  rotation:
    enabled: false
    max_size: 100
    max_backups: 3
    max_age: 28
    compress: true

# Static Analysis Configuration (Enhanced for Better Detection)
static_analysis:
  enabled: true
  yara_rules_path: "./rules/enhanced_malware_detection.yara"
  max_file_size: 10485760  # 10MB
  scan_archives: true
  deep_scan: true
  sensitivity: "high"
  timeout: "30s"
  parallel_scanning: true
  typo_detection:
    enabled: true
    threshold: 0.75  # Lowered from 0.85 for better detection
    levenshtein_distance: 3  # Increased from 2 for more flexibility
    popular_packages_only: false
  signature_updates:
    auto_update: true
    update_interval: "24h"

# Dynamic Analysis Configuration
dynamic_analysis:
  enabled: true
  sandbox_type: "docker"
  sandbox_image: "ubuntu:20.04"
  sandbox_timeout: "5m"
  memory_limit: 512
  network_isolation: true
  file_system_monitoring: true

# Machine Learning Configuration (Tuned for Better Typosquatting Detection)
ml_analysis:
  enabled: true
  model_path: "./ml/models/"
  similarity_threshold: 0.65  # Lowered from 0.8 for higher sensitivity
  malicious_threshold: 0.6    # Lowered from 0.729 for better detection
  reputation_threshold: 0.4   # Lowered from 0.5 for stricter reputation checks
  anomaly_threshold: 0.5      # Lowered from 0.6 for better anomaly detection
  typo_threshold: 0.7         # Lowered from 0.85 for enhanced typo detection
  confidence_threshold: 0.65  # Lowered from 0.75 for more inclusive detection
  feature_extraction: true
  ensemble_weights:
    similarity: 0.35    # Increased weight for similarity (was 0.216)
    malware: 0.25       # Slightly reduced (was 0.294)
    anomaly: 0.15       # Slightly reduced (was 0.196)
    typo: 0.15          # Slightly reduced (was 0.196)
    reputation: 0.1     # Slightly increased (was 0.098)

# Behavioral Analysis Configuration (Tuned for Better Performance)
behavioral_analysis:
  enabled: true
  monitor_network: true
  monitor_filesystem: true
  monitor_processes: true
  anomaly_threshold: 0.55  # Lowered from 0.65 for better detection
  sensitivity: "high"
  false_positive_reduction: true
  timeout: "10s"

# Provenance Analysis Configuration
provenance_analysis:
  enabled: true
  verify_signatures: true
  check_supply_chain: true
  trust_threshold: 0.8  # Lowered from 0.9 for stricter checks

# Typo Detection Configuration (Enhanced)
typo_detection:
  enabled: true
  algorithms:
    - "levenshtein"
    - "jaro_winkler"
    - "soundex"
    - "metaphone"
  threshold: 0.65  # Lowered for better detection
  max_distance: 3  # Increased from 2
  check_similar_names: true
  check_homoglyphs: true
  check_keyboard_layout: true
  check_common_typos: true
  popular_packages_path: "./data/popular_packages.json"
  custom_dictionary:
    - "lodash"
    - "react"
    - "express"
    - "requests"
    - "numpy"
    - "flask"
    - "django"
    - "tensorflow"
    - "pytorch"
    - "gin"
    - "mux"
    - "logrus"
  language_specific: true
  case_sensitive: false

# Detection Configuration (Enhanced)
detection:
  enabled: true
  min_package_name_length: 1
  enhanced_typosquatting: true
  homoglyph_detection: true
  dependency_confusion: true
  reputation_scoring: true
  thresholds:
    similarity: 0.65   # Lowered from default
    confidence: 0.6    # Lowered from default
    reputation: 0.4    # Lowered from default
  algorithms:
    lexical: true
    homoglyph: true
    ml: true

# Malware Detection Configuration
malware_detection:
  enabled: true
  signature_database: "./signatures/malware.db"
  heuristic_analysis: true
  behavioral_analysis: true
  sandbox_analysis: true
  cloud_scanning: true
  real_time_protection: true
  quarantine_enabled: true
  quarantine_path: "./quarantine/"
  update_interval: "12h"  # More frequent updates
  max_scan_size: "50MB"
  scan_timeout: "60s"
  exclude_extensions: []
  include_extensions: [".js", ".py", ".go", ".json", ".yaml", ".yml"]

# Vulnerability Scanning Configuration
vulnerability_scanning:
  enabled: true
  databases:
    - "nvd"
    - "osv"
    - "github"
    - "snyk"
  severity_threshold: "low"  # More inclusive
  include_dev_dependencies: true
  include_transitive_dependencies: true
  max_depth: 5
  fail_on_vulnerabilities: false
  timeout: "120s"
  retry_attempts: 3
  cache_results: true
  cache_ttl: "6h"

# Reporting Configuration
reporting:
  enabled: true
  formats:
    - "json"
    - "yaml"
    - "html"
  output_dir: "./reports/"
  include_summary: true
  include_details: true
  include_recommendations: true
  include_metadata: true
  include_timestamps: true
  group_by_category: true
  sort_by_severity: true
  filter_by_severity: ["low", "medium", "high", "critical"]
  compression_enabled: false
  encryption_enabled: false

# Output Configuration
output:
  format: "json"
  file: ""
  stdout: true
  color_enabled: true
  progress_bar: true
  verbose_output: true
  quiet_mode: false
  timestamps: true
  line_numbers: false
  pretty_print: true
  max_width: 120
  truncate_output: false
  max_lines: 1000

# Performance Configuration
performance:
  max_concurrency: 8
  worker_pool_size: 10
  queue_size: 100
  batch_size: 20
  memory_limit: "2GB"
  cpu_limit: "80%"
  timeouts:
    global: "30m"
    connection: "30s"
    read: "60s"
    write: "30s"
  rate_limiting:
    enabled: true
    requests_per_second: 10
    burst_size: 20

# Security Configuration
security:
  api_key_required: false
  rate_limiting: true
  audit_logging:
    enabled: true
    level: "info"
    format: "json"
    output: "./logs/audit.log"
    rotation_enabled: true
    max_size: "100MB"
    max_age: "30d"
    max_backups: 5
    compression_enabled: true
  secure_communication: true

# Cache Configuration
cache:
  enabled: true
  type: "memory"  # memory, redis, file
  ttl: "24h"
  max_size: 1000
  cleanup_interval: "1h"

# Registry Configuration
registries:
  - name: "npm"
    enabled: true
    base_url: "https://registry.npmjs.org"
    timeout: "30s"
    rate_limit:
      enabled: true
      rps: 10
      burst: 20
  - name: "pypi"
    enabled: true
    base_url: "https://pypi.org"
    timeout: "30s"
    rate_limit:
      enabled: true
      rps: 10
      burst: 20
  - name: "go"
    enabled: true
    base_url: "https://proxy.golang.org"
    timeout: "30s"
    rate_limit:
      enabled: true
      rps: 10
      burst: 20