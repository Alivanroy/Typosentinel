# Enhanced SIEM Integration Configuration
# This example demonstrates the new features added to the SIEM integration

siem:
  enabled: true
  type: "splunk"  # Options: splunk, elastic, elasticsearch, qradar
  endpoint: "https://your-splunk-instance.com:8088/services/collector"
  api_key: "your-hec-token-here"
  index: "typosentinel"
  batch_size: 100
  
  # NEW: Enable streaming mode for real-time event processing
  streaming_mode: true
  
  # NEW: Custom timeout configuration
  timeout: "30s"
  
  # NEW: SSL verification (default: true)
  verify_ssl: true
  
  # NEW: Compression type for large payloads
  compression_type: "gzip"  # Options: gzip, none
  
  # NEW: Enhanced retry configuration
  retry_config:
    max_retries: 3
    initial_delay: "1s"
    max_delay: "30s"
    backoff_factor: 2.0
    retry_on_status: [429, 500, 502, 503, 504]
  
  # NEW: Custom field mapping for different SIEM formats
  custom_format:
    # Map Typosentinel fields to custom SIEM fields
    "security_event_type": "type"
    "event_timestamp": "timestamp"
    "alert_severity": "severity"
    "source_system": "source"
    "repository_name": "repository"
    "scan_identifier": "scan_id"
    "event_description": "message"
    "threat_indicators": "threat_count"
    "risk_assessment": "risk_score"
    # Static fields
    "product": "Typosentinel"
    "vendor": "Security Team"
    "category": "Supply Chain Security"

---
# Alternative configuration for Elasticsearch
siem_elasticsearch:
  enabled: true
  type: "elasticsearch"
  endpoint: "https://your-elastic-cluster.com:9200"
  api_key: "your-api-key-here"
  index: "typosentinel-events"
  batch_size: 50
  streaming_mode: true
  timeout: "45s"
  
  retry_config:
    max_retries: 5
    initial_delay: "2s"
    max_delay: "60s"
    backoff_factor: 1.5
    retry_on_status: [429, 500, 502, 503, 504, 408]
  
  # Elasticsearch-specific custom format
  custom_format:
    "@timestamp": "timestamp"
    "event.kind": "alert"
    "event.category": "threat"
    "event.type": "indicator"
    "event.severity": "severity"
    "source.name": "source"
    "typosentinel.repository": "repository"
    "typosentinel.scan_id": "scan_id"
    "typosentinel.threat_count": "threat_count"
    "typosentinel.risk_score": "risk_score"

---
# Alternative configuration for QRadar
siem_qradar:
  enabled: true
  type: "qradar"
  endpoint: "https://your-qradar-instance.com/api/ariel/events"
  api_key: "your-qradar-token"
  batch_size: 25
  streaming_mode: false  # QRadar works better with synchronous sends
  timeout: "60s"
  
  retry_config:
    max_retries: 2
    initial_delay: "3s"
    max_delay: "45s"
    backoff_factor: 2.5
    retry_on_status: [429, 500, 502, 503]
  
  # QRadar-specific format (automatically handled by the client)
  custom_format:
    "EventName": "type"
    "Description": "message"
    "SourceIP": "127.0.0.1"
    "EventCategory": "Security"
    "Custom_Repository": "repository"
    "Custom_ScanID": "scan_id"
    "Custom_ThreatCount": "threat_count"

---
# Performance tuning examples
siem_high_volume:
  enabled: true
  type: "splunk"
  endpoint: "https://splunk-cluster.com:8088/services/collector"
  api_key: "high-volume-token"
  index: "typosentinel-bulk"
  
  # High-volume configuration
  batch_size: 500
  streaming_mode: true
  timeout: "120s"
  compression_type: "gzip"
  
  retry_config:
    max_retries: 5
    initial_delay: "500ms"
    max_delay: "10s"
    backoff_factor: 1.8
    retry_on_status: [429, 500, 502, 503, 504]
  
  # Minimal custom format for performance
  custom_format:
    "event_type": "type"
    "timestamp": "timestamp"
    "severity": "severity"
    "repo": "repository"

---
# Development/Testing configuration
siem_dev:
  enabled: true
  type: "splunk"
  endpoint: "http://localhost:8088/services/collector"
  api_key: "dev-token"
  index: "typosentinel-dev"
  batch_size: 10
  streaming_mode: false  # Synchronous for easier debugging
  timeout: "10s"
  verify_ssl: false  # For local development
  
  retry_config:
    max_retries: 1
    initial_delay: "1s"
    max_delay: "5s"
    backoff_factor: 2.0
    retry_on_status: [500, 502, 503]
  
  # Detailed format for debugging
  custom_format:
    "debug_type": "type"
    "debug_timestamp": "timestamp"
    "debug_severity": "severity"
    "debug_source": "source"
    "debug_repository": "repository"
    "debug_scan_id": "scan_id"
    "debug_message": "message"
    "debug_details": "details"
    "debug_threat_count": "threat_count"
    "debug_risk_score": "risk_score"
    "environment": "development"