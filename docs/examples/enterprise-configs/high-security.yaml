# TypoSentinel Enterprise High-Security Configuration
# Optimized for enterprise environments with maximum security requirements
# Suitable for: Financial services, Healthcare, Government, Critical infrastructure

# Scanner configuration - Maximum thoroughness
scanner:
  # Extended timeout for comprehensive scanning
  timeout: "300s"
  
  # High concurrency for faster processing
  max_concurrency: 10
  
  # Minimal exclusions - scan everything possible
  exclude_patterns:
    - ".git"
    - "*.log"
    - "*.tmp"
    # Note: Not excluding node_modules, vendor, etc. for maximum coverage
  
  # Include ALL dependencies including development
  include_dev_deps: true
  
  # Deep scanning for maximum detection
  scan_depth: "deep"
  
  # Enable recursive dependency analysis
  recursive_analysis: true
  
  # Maximum dependency depth to analyze
  max_dependency_depth: 10

# Threat detection - Highly sensitive settings
detector:
  # Very sensitive thresholds for maximum detection
  thresholds:
    # Lower threshold = more sensitive detection
    typosquatting: 0.6
    suspicious_name: 0.5
    dependency_confusion: 0.6
    malicious_patterns: 0.7
    reputation_score: 0.8
    
    # Additional enterprise thresholds
    supply_chain_risk: 0.7
    maintainer_trust: 0.8
    package_age: 0.6
  
  # All available detection algorithms
  algorithms:
    - "levenshtein"
    - "jaro_winkler"
    - "soundex"
    - "metaphone"
    - "damerau_levenshtein"
    - "hamming"
    - "jaccard"
  
  # Strict popularity requirements
  min_popularity_threshold: 1000
  
  # Enable all heuristic analysis
  enable_heuristics: true
  enable_ml_analysis: true
  enable_behavioral_analysis: true
  enable_reputation_analysis: true
  
  # Enterprise-specific detections
  enable_supply_chain_analysis: true
  enable_maintainer_verification: true
  enable_license_compliance: true

# Output configuration - Comprehensive reporting
output:
  # SARIF format for enterprise security tools integration
  format: "sarif"
  
  # Include maximum detail
  include_package_details: true
  include_metadata: true
  include_confidence: true
  include_recommendations: true
  include_remediation_steps: true
  
  # Enterprise reporting features
  include_compliance_info: true
  include_risk_assessment: true
  include_executive_summary: true
  
  # Pretty print for readability
  pretty_print: true

# Registry configuration - Comprehensive coverage
registries:
  npm:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true
  
  pypi:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true
  
  maven:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true
  
  nuget:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true
  
  go:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true
  
  rubygems:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true
  
  cargo:
    enabled: true
    api_timeout: "60s"
    verify_signatures: true
    check_integrity: true

# Logging configuration - Audit trail
logging:
  # Debug level for maximum visibility
  level: "debug"
  
  # Structured logging for SIEM integration
  structured: true
  
  # Audit logging
  audit_log: true
  audit_file: "/var/log/typosentinel/audit.log"
  
  # Main log file
  file: "/var/log/typosentinel/typosentinel.log"
  
  # Log rotation
  max_size: "100MB"
  max_backups: 10
  max_age: 30

# Performance tuning - Enterprise scale
performance:
  # Enable caching for performance
  enable_cache: true
  cache_duration: "12h"  # Shorter cache for fresh data
  
  # Higher memory limit for large projects
  memory_limit: "2GB"
  
  # Enable all performance optimizations
  parallel_processing: true
  batch_processing: true
  connection_pooling: true
  
  # Rate limiting for API calls
  api_rate_limit: 100
  api_burst_limit: 200

# Security settings - Maximum security
security:
  # Verify everything possible
  verify_signatures: true
  verify_checksums: true
  verify_certificates: true
  
  # Comprehensive vulnerability checking
  check_vulnerabilities: true
  vulnerability_databases:
    - "nvd"
    - "github"
    - "snyk"
    - "osv"
  
  # Reputation and trust verification
  reputation_checking: true
  maintainer_verification: true
  
  # Supply chain security
  supply_chain_verification: true
  provenance_verification: true
  
  # Compliance checking
  license_compliance: true
  export_control_compliance: true

# Reporting configuration - Enterprise requirements
reporting:
  # Generate comprehensive reports
  generate_summary: true
  generate_detailed_report: true
  generate_executive_summary: true
  
  # Include all recommendations
  include_recommendations: true
  include_remediation_steps: true
  include_compliance_status: true
  
  # Report all severity levels
  severity_levels:
    - "info"
    - "low"
    - "medium"
    - "high"
    - "critical"
  
  # Enterprise reporting features
  risk_scoring: true
  trend_analysis: true
  benchmark_comparison: true

# Compliance configuration
compliance:
  # Regulatory frameworks
  frameworks:
    - "SOC2"
    - "ISO27001"
    - "NIST"
    - "PCI-DSS"
    - "HIPAA"
    - "GDPR"
  
  # Compliance requirements
  require_license_approval: true
  require_vulnerability_assessment: true
  require_supply_chain_verification: true
  
  # Audit requirements
  audit_trail: true
  evidence_collection: true
  compliance_reporting: true

# Integration configuration
integrations:
  # SIEM integration
  siem:
    enabled: true
    format: "cef"
    endpoint: "https://siem.company.com/api/events"
  
  # Vulnerability management
  vulnerability_management:
    enabled: true
    platform: "qualys"  # or "rapid7", "tenable", etc.
  
  # Ticketing system
  ticketing:
    enabled: true
    system: "jira"
    project_key: "SEC"
    priority_mapping:
      critical: "Highest"
      high: "High"
      medium: "Medium"
      low: "Low"
  
  # Notification systems
  notifications:
    email:
      enabled: true
      smtp_server: "smtp.company.com"
      recipients:
        - "security-team@company.com"
        - "devops-team@company.com"
    
    slack:
      enabled: true
      webhook_url: "https://hooks.slack.com/services/..."
      channel: "#security-alerts"
    
    teams:
      enabled: true
      webhook_url: "https://company.webhook.office.com/..."

# Policy enforcement
policy:
  # Blocking policies
  block_on_critical: true
  block_on_high: true
  block_on_unknown_packages: true
  
  # Approval workflows
  require_approval_for:
    - "new_dependencies"
    - "version_updates"
    - "license_changes"
  
  # Whitelist/blacklist
  package_whitelist: []  # Explicitly approved packages
  package_blacklist: []  # Explicitly blocked packages
  
  # License policies
  allowed_licenses:
    - "MIT"
    - "Apache-2.0"
    - "BSD-3-Clause"
    - "ISC"
  
  prohibited_licenses:
    - "GPL-3.0"
    - "AGPL-3.0"
    - "SSPL-1.0"

# Advanced features
advanced:
  # Machine learning enhancements
  ml_model_updates: true
  behavioral_learning: true
  anomaly_detection: true
  
  # Threat intelligence
  threat_intelligence_feeds: true
  ioc_checking: true
  attribution_analysis: true
  
  # Forensics
  evidence_preservation: true
  chain_of_custody: true
  forensic_reporting: true