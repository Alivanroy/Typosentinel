# Enterprise Security Configuration for TypoSentinel
enterprise:
  name: "Enterprise Security Environment"
  version: "2.1.0"
  environment: "production"
  
security_policies:
  threat_thresholds:
    critical: 0  # Zero tolerance for critical threats
    high: 2      # Maximum 2 high threats allowed
    medium: 10   # Maximum 10 medium threats allowed
    low: 50      # Maximum 50 low threats allowed
    
  vulnerability_scanning:
    enabled: true
    databases: ["osv", "nvd", "github", "snyk"]
    auto_update: true
    scan_frequency: "daily"
    
  supply_chain:
    attestation_required: true
    provenance_verification: true
    sbom_generation: true
    license_compliance: true
    
  edge_algorithms:
    aicc:
      enabled: true
      adaptive_mode: true
      correlation_analysis: true
      confidence_threshold: 0.8
    gtr:
      enabled: true
      deep_analysis: true
      pattern_matching: true
    dirt:
      enabled: true
      behavioral_analysis: true
      anomaly_detection: true
      
monitoring:
  alerts:
    slack:
      webhook_url: "${SLACK_WEBHOOK_URL}"
      channels: ["#security-alerts", "#devops"]
    email:
      smtp_server: "smtp.enterprise.com"
      recipients: ["security@enterprise.com", "devops@enterprise.com"]
    pagerduty:
      integration_key: "${PAGERDUTY_INTEGRATION_KEY}"
      
  metrics:
    prometheus:
      enabled: true
      endpoint: "http://prometheus:9090"
    grafana:
      enabled: true
      dashboard_id: "enterprise-security"
    elasticsearch:
      enabled: true
      index: "typosentinel-logs"
      
  logging:
    level: "info"
    format: "json"
    outputs: ["stdout", "file", "elasticsearch"]
    retention_days: 90
    
scanning:
  schedules:
    full_scan: "0 2 * * *"      # Daily at 2 AM
    quick_scan: "0 */6 * * *"   # Every 6 hours
    dependency_update: "0 4 * * 1"  # Weekly on Monday at 4 AM
    
  targets:
    - path: "frontend"
      type: "nodejs"
      priority: "high"
      deep_analysis: true
      
    - path: "backend"
      type: "golang"
      priority: "critical"
      deep_analysis: true
      
    - path: "microservices/auth-service"
      type: "golang"
      priority: "critical"
      deep_analysis: true
      
    - path: "microservices/payment-service"
      type: "nodejs"
      priority: "critical"
      deep_analysis: true
      
    - path: "microservices/notification-service"
      type: "nodejs"
      priority: "high"
      deep_analysis: true
      
    - path: "microservices/analytics-service"
      type: "golang"
      priority: "high"
      deep_analysis: true
      
integrations:
  ci_cd:
    github_actions: true
    jenkins: true
    gitlab_ci: true
    
  security_tools:
    sonarqube:
      enabled: true
      server_url: "https://sonarqube.enterprise.com"
    snyk:
      enabled: true
      api_token: "${SNYK_API_TOKEN}"
    veracode:
      enabled: true
      api_id: "${VERACODE_API_ID}"
      api_key: "${VERACODE_API_KEY}"
      
  ticketing:
    jira:
      enabled: true
      server_url: "https://enterprise.atlassian.net"
      project_key: "SEC"
      
compliance:
  frameworks:
    - "SOC2"
    - "ISO27001"
    - "PCI-DSS"
    - "GDPR"
    
  reporting:
    frequency: "monthly"
    recipients: ["compliance@enterprise.com", "ciso@enterprise.com"]
    formats: ["pdf", "json", "csv"]
    
  audit_trail:
    enabled: true
    retention_years: 7
    encryption: true
    
performance:
  scanning:
    max_workers: 8
    timeout_minutes: 30
    memory_limit_gb: 4
    
  caching:
    enabled: true
    ttl_hours: 24
    redis_url: "redis://redis:6379"
    
  rate_limiting:
    api_calls_per_minute: 1000
    concurrent_scans: 5
    
notifications:
  severity_mapping:
    critical:
      channels: ["slack", "email", "pagerduty"]
      immediate: true
    high:
      channels: ["slack", "email"]
      immediate: true
    medium:
      channels: ["slack"]
      immediate: false
    low:
      channels: ["slack"]
      immediate: false
      
  templates:
    critical: |
      ðŸš¨ CRITICAL SECURITY THREAT DETECTED ðŸš¨
      Service: {{.service}}
      Threat: {{.threat_type}}
      Package: {{.package_name}}
      Severity: {{.severity}}
      Action Required: IMMEDIATE
      
    summary: |
      ðŸ“Š Daily Security Summary
      Total Packages Scanned: {{.total_packages}}
      Threats Found: {{.total_threats}}
      Critical: {{.critical_count}}
      High: {{.high_count}}
      Medium: {{.medium_count}}
      Low: {{.low_count}}