{
  "timestamp": "2025-06-14T15:08:34.018462+02:00",
  "total_tests": 2,
  "passed_tests": 1,
  "failed_tests": 1,
  "overall_accuracy": 0.5,
  "detection_rate": 0,
  "false_positive_rate": 0,
  "false_negative_rate": 0,
  "average_response_time": 0,
  "detector_results": {
    "anomaly": {
      "detector_name": "anomaly",
      "total_detections": 1,
      "correct_detections": 1,
      "false_positives": 0,
      "false_negatives": 0,
      "accuracy": 1,
      "precision": 1,
      "recall": 1,
      "f1_score": 1,
      "average_response_time": 2291,
      "error_rate": 0,
      "confidence_scores": [
        0
      ]
    },
    "behavioral": {
      "detector_name": "behavioral",
      "total_detections": 1,
      "correct_detections": 0,
      "false_positives": 1,
      "false_negatives": 0,
      "accuracy": 0,
      "precision": 0,
      "recall": 0,
      "f1_score": 0,
      "average_response_time": 2000478708,
      "error_rate": 0,
      "confidence_scores": [
        0
      ]
    },
    "ml": {
      "detector_name": "ml",
      "total_detections": 1,
      "correct_detections": 1,
      "false_positives": 0,
      "false_negatives": 0,
      "accuracy": 1,
      "precision": 1,
      "recall": 1,
      "f1_score": 1,
      "average_response_time": 4541,
      "error_rate": 0,
      "confidence_scores": [
        0
      ]
    },
    "static": {
      "detector_name": "static",
      "total_detections": 2,
      "correct_detections": 1,
      "false_positives": 0,
      "false_negatives": 1,
      "accuracy": 0.5,
      "precision": 1,
      "recall": 0.5,
      "f1_score": 0.6666666666666666,
      "average_response_time": 0,
      "error_rate": 0,
      "confidence_scores": [
        0,
        0
      ]
    },
    "typo": {
      "detector_name": "typo",
      "total_detections": 2,
      "correct_detections": 1,
      "false_positives": 0,
      "false_negatives": 1,
      "accuracy": 0.5,
      "precision": 1,
      "recall": 0.5,
      "f1_score": 0.6666666666666666,
      "average_response_time": 27187,
      "error_rate": 0,
      "confidence_scores": [
        0,
        0
      ]
    },
    "yara": {
      "detector_name": "yara",
      "total_detections": 2,
      "correct_detections": 1,
      "false_positives": 0,
      "false_negatives": 1,
      "accuracy": 0.5,
      "precision": 1,
      "recall": 0.5,
      "f1_score": 0.6666666666666666,
      "average_response_time": 0,
      "error_rate": 0,
      "confidence_scores": [
        0,
        0
      ]
    }
  },
  "test_case_results": [
    {
      "test_case": {
        "id": "malicious_lodahs",
        "name": "Malicious lodahs package",
        "description": "Test detection of the malicious lodahs typosquatting package",
        "package_path": "./test_packages/lodahs",
        "expected_threat": true,
        "threat_type": "typosquatting",
        "severity": "high",
        "expected_iocs": [
          "typosquatting",
          "malicious_code",
          "data_exfiltration"
        ],
        "metadata": null,
        "timeout": 30000000000,
        "required_detectors": [
          "static",
          "yara",
          "typo"
        ]
      },
      "passed": false,
      "detected": false,
      "threat_type": "unknown",
      "confidence": 0,
      "response_time": 58209,
      "detector_results": {
        "static": {
          "detected": false,
          "confidence": 0,
          "threat_type": "",
          "iocs": null,
          "response_time": 0,
          "error": "failed to walk package directory: lstat ./test_packages/lodahs: no such file or directory",
          "metadata": {}
        },
        "typo": {
          "detected": false,
          "confidence": 0,
          "threat_type": "typosquatting",
          "iocs": null,
          "response_time": 8791,
          "metadata": {
            "similar_packages": null,
            "typo_confidence": 0
          }
        },
        "yara": {
          "detected": false,
          "confidence": 0,
          "threat_type": "",
          "iocs": null,
          "response_time": 0,
          "error": "lstat ./test_packages/lodahs: no such file or directory",
          "metadata": {}
        }
      },
      "iocs_found": [],
      "additional_metadata": {}
    },
    {
      "test_case": {
        "id": "clean_lodash",
        "name": "Clean lodash package",
        "description": "Test that legitimate lodash package is not flagged",
        "package_path": "./test_packages/lodash",
        "expected_threat": false,
        "threat_type": "none",
        "severity": "none",
        "expected_iocs": null,
        "metadata": null,
        "timeout": 30000000000,
        "required_detectors": null
      },
      "passed": true,
      "detected": false,
      "threat_type": "unknown",
      "confidence": 0,
      "response_time": 2000587208,
      "detector_results": {
        "anomaly": {
          "detected": false,
          "confidence": 0,
          "threat_type": "anomaly",
          "iocs": null,
          "response_time": 2291,
          "metadata": {
            "anomalies_count": 0,
            "anomaly_score": 0
          }
        },
        "behavioral": {
          "detected": true,
          "confidence": 0,
          "threat_type": "behavioral",
          "iocs": null,
          "response_time": 2000478708,
          "metadata": {
            "pattern_matches": 0,
            "threat_level": "minimal"
          }
        },
        "ml": {
          "detected": false,
          "confidence": 0,
          "threat_type": "unknown",
          "iocs": null,
          "response_time": 4541,
          "metadata": {
            "anomaly_score": 0,
            "malware_score": 0
          }
        },
        "static": {
          "detected": false,
          "confidence": 0,
          "threat_type": "",
          "iocs": null,
          "response_time": 0,
          "error": "failed to walk package directory: lstat ./test_packages/lodash: no such file or directory",
          "metadata": {}
        },
        "typo": {
          "detected": false,
          "confidence": 0,
          "threat_type": "typosquatting",
          "iocs": null,
          "response_time": 45583,
          "metadata": {
            "similar_packages": null,
            "typo_confidence": 0
          }
        },
        "yara": {
          "detected": false,
          "confidence": 0,
          "threat_type": "",
          "iocs": null,
          "response_time": 0,
          "error": "lstat ./test_packages/lodash: no such file or directory",
          "metadata": {}
        }
      },
      "iocs_found": [],
      "additional_metadata": {}
    }
  ],
  "performance_metrics": {
    "total_execution_time": 2000672167,
    "average_test_time": 1000336083,
    "median_test_time": 0,
    "p95_test_time": 0,
    "p99_test_time": 0,
    "throughput": 0.9996640294141704,
    "memory_usage": 0,
    "cpu_usage": 0,
    "concurrent_tests": 0
  },
  "recommendations": [
    "Overall accuracy below 99% target - review failed test cases",
    "static detector accuracy below 95% - requires tuning",
    "behavioral detector accuracy below 95% - requires tuning",
    "behavioral detector has high false positive rate",
    "yara detector accuracy below 95% - requires tuning",
    "typo detector accuracy below 95% - requires tuning"
  ],
  "summary": {
    "overall_grade": "F",
    "effectiveness_score": 0.5,
    "key_findings": [
      "ml detector performing excellently (100.0% accuracy)",
      "yara detector underperforming (50.0% accuracy)",
      "typo detector underperforming (50.0% accuracy)",
      "anomaly detector performing excellently (100.0% accuracy)",
      "static detector underperforming (50.0% accuracy)",
      "behavioral detector underperforming (0.0% accuracy)"
    ],
    "critical_issues": [
      "Overall detection accuracy critically low",
      "yara detector missing threats (1 false negatives)",
      "typo detector missing threats (1 false negatives)",
      "static detector missing threats (1 false negatives)"
    ],
    "recommendations": [
      "Overall accuracy below 99% target - review failed test cases",
      "static detector accuracy below 95% - requires tuning",
      "behavioral detector accuracy below 95% - requires tuning",
      "behavioral detector has high false positive rate",
      "yara detector accuracy below 95% - requires tuning",
      "typo detector accuracy below 95% - requires tuning"
    ],
    "next_steps": [
      "Analyze failed test cases and improve detection rules",
      "Retrain ML models with additional data",
      "Implement ensemble voting for better accuracy"
    ],
    "compliance_status": "NON_COMPLIANT"
  }
}