# Test Configuration for Typosentinel
# This file contains test data for various attack scenarios

# 1. Known Malicious Packages Database
malicious_packages:
  npm:
    - name: "crossenv"
      legitimate: "cross-env"
      discovered: "2017-08-01"
      severity: "critical"
      description: "Typosquatting attack stealing npm credentials"
      
    - name: "babelcli"
      legitimate: "babel-cli"
      discovered: "2018-05-02"
      severity: "high"
      description: "Typosquatted babel-cli with malicious postinstall"
      
    - name: "event-stream"
      version: "3.3.6"
      discovered: "2018-11-26"
      severity: "critical"
      description: "Legitimate package compromised with cryptocurrency theft code"
      
    - name: "electron-native-notify"
      discovered: "2019-06-04"
      severity: "critical"
      description: "Malicious package stealing cryptocurrency wallets"
      
    - name: "fallguys"
      discovered: "2020-08-28"
      severity: "high"
      description: "Malware disguised as game-related package"
      
    - name: "ua-parser-js"
      versions: ["0.7.29", "0.8.0", "1.0.0"]
      discovered: "2021-10-22"
      severity: "critical"
      description: "Compromised with crypto mining malware"
      
    - name: "node-ipc"
      versions: ["10.1.1", "10.1.2"]
      discovered: "2022-03-15"
      severity: "high"
      description: "Malicious code targeting Russian/Belarusian IPs"
      
    - name: "colors"
      version: "1.4.1"
      discovered: "2022-01-08"
      severity: "high"
      description: "Package sabotaged by maintainer"

  pypi:
    - name: "colourama"
      legitimate: "colorama"
      discovered: "2021-03-20"
      severity: "high"
      description: "Typosquatting colorama with info stealer"
      
    - name: "python-binance"
      legitimate: "python-binance"
      discovered: "2022-05-15"
      severity: "critical"
      description: "Fake package stealing API keys"
      
    - name: "pytorch-lightning"
      legitimate: "pytorch-lightning"
      discovered: "2022-12-30"
      severity: "critical"
      description: "Malicious package with backdoor"
      
    - name: "beautifulsoup"
      legitimate: "beautifulsoup4"
      discovered: "2021-07-10"
      severity: "medium"
      description: "Missing version number typosquatting"

# 2. Typosquatting Patterns
typosquatting_patterns:
  character_substitution:
    - pattern: "lodash -> lodahs"
    - pattern: "react -> reacr"
    - pattern: "jquery -> jqeury"
    
  character_transposition:
    - pattern: "request -> requset"
    - pattern: "angular -> agnular"
    - pattern: "webpack -> webpcak"
    
  missing_characters:
    - pattern: "express -> expres"
    - pattern: "mongoose -> mongose"
    - pattern: "passport -> pasport"
    
  extra_characters:
    - pattern: "axios -> axioss"
    - pattern: "moment -> momentt"
    - pattern: "babel -> babell"
    
  homoglyphs:
    - pattern: "lodash -> 1odash (l->1)"
    - pattern: "node -> n0de (o->0)"
    - pattern: "react -> reаct (a->а cyrillic)"
    
  separator_confusion:
    - pattern: "babel-core -> babel_core"
    - pattern: "react-dom -> react.dom"
    - pattern: "vue-router -> vuerouter"

# 3. Dependency Confusion Patterns
dependency_confusion:
  internal_package_indicators:
    - prefix: "internal-"
    - prefix: "private-"
    - prefix: "corp-"
    - suffix: "-internal"
    - suffix: "-private"
    - contains: "company"
    - contains: "proprietary"
    
  suspicious_scopes:
    - "@internal/*"
    - "@private/*"
    - "@corp/*"
    - "@company/*"

# 4. Supply Chain Attack Indicators
supply_chain_indicators:
  maintainer_changes:
    - sudden_new_maintainer: true
    - maintainer_email_changed: true
    - maintainer_removed: true
    
  version_anomalies:
    - major_version_jump: "1.0.0 -> 10.0.0"
    - version_rollback: "2.0.0 -> 1.9.9"
    - suspicious_versioning: "1.2.3-malicious"
    
  behavioral_changes:
    - new_install_scripts: true
    - new_network_calls: true
    - new_file_access: true
    - obfuscated_code: true
    - minified_source: true

# 5. Test Scenarios
test_scenarios:
  - name: "Basic Typosquatting Detection"
    description: "Test detection of common typosquatting patterns"
    packages:
      - "lodahs"
      - "expres"
      - "reacr"
      - "axois"
    expected_result: "high_risk"
    
  - name: "Homoglyph Attack Detection"
    description: "Test detection of visual similarity attacks"
    packages:
      - "1odash"
      - "n0de"
      - "јquery"  # j is cyrillic
    expected_result: "high_risk"
    
  - name: "Dependency Confusion"
    description: "Test internal package name detection"
    packages:
      - "internal-utils"
      - "company-auth"
      - "@corp/logger"
    expected_result: "medium_risk"
    
  - name: "Known Compromised Packages"
    description: "Test detection of historically compromised packages"
    packages:
      - "event-stream@3.3.6"
      - "ua-parser-js@0.7.29"
      - "colors@1.4.1"
    expected_result: "critical_risk"
    
  - name: "Legitimate Packages"
    description: "Test false positive rate on legitimate packages"
    packages:
      - "lodash"
      - "express"
      - "react"
      - "numpy"
      - "django"
    expected_result: "low_risk"

# 6. Performance Benchmarks
performance_benchmarks:
  single_package_scan:
    target_time: 1.5  # seconds
    packages:
      - "express"
      - "lodash"
      - "react"
      
  bulk_scan:
    target_time: 10  # seconds
    package_count: 20
    
  project_scan:
    target_time: 30  # seconds
    project_size: "large"  # 100+ dependencies
    
  memory_usage:
    max_memory: 512  # MB
    
  concurrent_requests:
    target_rps: 100  # requests per second

# 7. CI/CD Test Configuration
ci_cd_config:
  fail_on_severity: "high"
  
  ignored_packages:
    - "internal-dev-tools"
    - "test-utils"
    
  custom_rules:
    - rule: "block_all_typosquatting"
      enabled: true
      
    - rule: "allow_known_internal"
      enabled: true
      patterns:
        - "@mycompany/*"
        
    - rule: "require_signature"
      enabled: false
      registries:
        - "npm"
        - "pypi"

# 8. Reporting Configuration
reporting:
  formats:
    - json
    - yaml
    - csv
    - sarif
    - junit
    - html
    
  include_in_report:
    - package_details
    - threat_analysis
    - ml_scores
    - recommendations
    - remediation_steps
    
  notification_channels:
    - type: "slack"
      webhook: "${SLACK_WEBHOOK_URL}"
      severity: ["critical", "high"]
      
    - type: "email"
      smtp_server: "${SMTP_SERVER}"
      recipients: ["security@company.com"]
      severity: ["critical"]
      
    - type: "jira"
      api_url: "${JIRA_API_URL}"
      project: "SEC"
      severity: ["critical", "high"]

# 9. Test Environment Configuration
test_environment:
  registries:
    npm:
      url: "https://registry.npmjs.org"
      timeout: 30
      rate_limit: 100
      
    pypi:
      url: "https://pypi.org/simple"
      timeout: 30
      rate_limit: 100
      
  cache:
    enabled: true
    ttl: 3600
    max_size: 1000
    
  ml_models:
    npm:
      model_path: "./models/npm_detector_v2.pkl"
      threshold: 0.85
      
    pypi:
      model_path: "./models/pypi_detector_v2.pkl"
      threshold: 0.80