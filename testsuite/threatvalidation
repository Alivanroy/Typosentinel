{
  "threat_database": {
    "version": "1.0",
    "last_updated": "2024-01-15T00:00:00Z",
    "total_threats": 150,
    "categories": {
      "typosquatting": {
        "description": "Packages that impersonate legitimate packages through similar names",
        "threats": [
          {
            "id": "TYPO-001",
            "malicious_package": "lodahs",
            "target_package": "lodash",
            "registry": "npm",
            "discovered": "2021-06-15",
            "risk_level": "HIGH",
            "attack_vector": "credential_harvesting",
            "description": "Mimics lodash utility library, harvests environment variables",
            "similarity_score": 0.92,
            "downloads_before_detection": 1250,
            "indicators": [
              "obfuscated_code",
              "external_data_transmission",
              "environment_access"
            ]
          },
          {
            "id": "TYPO-002", 
            "malicious_package": "recat",
            "target_package": "react",
            "registry": "npm",
            "discovered": "2021-08-20",
            "risk_level": "HIGH",
            "attack_vector": "code_injection",
            "description": "Typosquats React library, injects malicious code into builds",
            "similarity_score": 0.89,
            "downloads_before_detection": 892,
            "indicators": [
              "build_manipulation",
              "obfuscated_payload",
              "network_requests"
            ]
          },
          {
            "id": "TYPO-003",
            "malicious_package": "reqeusts", 
            "target_package": "requests",
            "registry": "pypi",
            "discovered": "2020-12-01",
            "risk_level": "HIGH",
            "attack_vector": "data_exfiltration",
            "description": "Mimics Python requests library, exfiltrates HTTP traffic",
            "similarity_score": 0.94,
            "downloads_before_detection": 2150,
            "indicators": [
              "network_interception",
              "data_logging",
              "external_transmission"
            ]
          },
          {
            "id": "TYPO-004",
            "malicious_package": "pilwo",
            "target_package": "pillow", 
            "registry": "pypi",
            "discovered": "2021-03-10",
            "risk_level": "MEDIUM",
            "attack_vector": "backdoor",
            "description": "Typosquats Pillow image library, contains hidden backdoor",
            "similarity_score": 0.87,
            "downloads_before_detection": 456,
            "indicators": [
              "hidden_functionality",
              "process_spawning",
              "file_system_access"
            ]
          },
          {
            "id": "TYPO-005",
            "malicious_package": "expresss",
            "target_package": "express",
            "registry": "npm", 
            "discovered": "2022-01-15",
            "risk_level": "HIGH",
            "attack_vector": "supply_chain",
            "description": "Typosquats Express.js framework, compromises web applications",
            "similarity_score": 0.91,
            "downloads_before_detection": 678,
            "indicators": [
              "middleware_injection",
              "request_interception",
              "credential_theft"
            ]
          }
        ]
      },
      "dependency_confusion": {
        "description": "Packages that exploit dependency confusion vulnerabilities",
        "threats": [
          {
            "id": "DEPCONF-001",
            "malicious_package": "internal-utils-v2",
            "target_namespace": "company-internal",
            "registry": "npm",
            "discovered": "2021-02-20",
            "risk_level": "HIGH", 
            "attack_vector": "dependency_confusion",
            "description": "Higher version number than internal package, gets prioritized",
            "version": "99.99.99",
            "indicators": [
              "version_inflation",
              "environment_harvesting",
              "network_beacon"
            ]
          },
          {
            "id": "DEPCONF-002",
            "malicious_package": "corp-auth-lib",
            "target_namespace": "private-registry",
            "registry": "pypi",
            "discovered": "2021-04-10",
            "risk_level": "CRITICAL",
            "attack_vector": "dependency_confusion", 
            "description": "Mimics private authentication library",
            "version": "10.0.0",
            "indicators": [
              "credential_access",
              "token_harvesting",
              "data_exfiltration"
            ]
          }
        ]
      },
      "malicious_new_packages": {
        "description": "New packages created with malicious intent",
        "threats": [
          {
            "id": "MALPACK-001",
            "malicious_package": "crypto-utils-2023",
            "registry": "npm",
            "discovered": "2023-01-15",
            "risk_level": "MEDIUM",
            "attack_vector": "cryptocurrency_theft",
            "description": "New package claiming crypto utilities, steals wallet data",
            "age_days": 5,
            "downloads": 45,
            "indicators": [
              "wallet_access",
              "key_harvesting",
              "suspicious_network_activity"
            ]
          },
          {
            "id": "MALPACK-002",
            "malicious_package": "system-info-collector",
            "registry": "pypi",
            "discovered": "2022-11-05",
            "risk_level": "HIGH",
            "attack_vector": "system_reconnaissance", 
            "description": "Collects detailed system information without user consent",
            "age_days": 12,
            "downloads": 156,
            "indicators": [
              "system_enumeration",
              "hardware_fingerprinting",
              "data_transmission"
            ]
          },
          {
            "id": "MALPACK-003",
            "malicious_package": "discord-token-logger",
            "registry": "npm",
            "discovered": "2022-09-20",
            "risk_level": "HIGH",
            "attack_vector": "credential_theft",
            "description": "Specifically targets Discord authentication tokens",
            "age_days": 3,
            "downloads": 234,
            "indicators": [
              "discord_token_access",
              "browser_data_access",
              "credential_exfiltration"
            ]
          }
        ]
      }
    }
  },
  "legitimate_packages": {
    "description": "Known legitimate packages for false positive testing",
    "packages": [
      {
        "name": "lodash",
        "registry": "npm",
        "weekly_downloads": 30000000,
        "maintainers": ["jdalton"],
        "first_published": "2012-04-23",
        "latest_version": "4.17.21",
        "description": "A modern JavaScript utility library delivering modularity, performance, & extras.",
        "repository": "https://github.com/lodash/lodash",
        "license": "MIT",
        "trust_indicators": [
          "high_download_count",
          "established_maintainer",
          "long_history",
          "active_development",
          "good_documentation"
        ]
      },
      {
        "name": "react",
        "registry": "npm",
        "weekly_downloads": 20000000,
        "maintainers": ["facebook"],
        "first_published": "2013-05-29",
        "latest_version": "18.2.0",
        "description": "React is a JavaScript library for building user interfaces.",
        "repository": "https://github.com/facebook/react",
        "license": "MIT",
        "trust_indicators": [
          "corporate_backing",
          "extensive_usage",
          "comprehensive_testing",
          "active_community",
          "regular_releases"
        ]
      },
      {
        "name": "requests",
        "registry": "pypi", 
        "weekly_downloads": 50000000,
        "maintainers": ["kennethreitz", "nateprewitt"],
        "first_published": "2011-02-13",
        "latest_version": "2.28.1",
        "description": "Python HTTP for Humans.",
        "repository": "https://github.com/psf/requests",
        "license": "Apache-2.0",
        "trust_indicators": [
          "python_foundation_endorsed",
          "widespread_adoption",
          "comprehensive_documentation",
          "stable_api",
          "security_focused"
        ]
      },
      {
        "name": "numpy",
        "registry": "pypi",
        "weekly_downloads": 40000000,
        "maintainers": ["numpy-team"],
        "first_published": "2006-01-01",
        "latest_version": "1.24.1",
        "description": "Fundamental package for array computing in Python",
        "repository": "https://github.com/numpy/numpy",
        "license": "BSD-3-Clause",
        "trust_indicators": [
          "scientific_community_standard",
          "academic_backing",
          "extensive_testing",
          "performance_optimized",
          "wide_ecosystem_support"
        ]
      }
    ]
  },
  "test_scenarios": {
    "typosquatting_patterns": [
      {
        "pattern_type": "character_substitution",
        "examples": [
          {"original": "request", "typosquat": "reqeust"},
          {"original": "express", "typosquat": "expresss"},
          {"original": "lodash", "typosquat": "lodahs"}
        ]
      },
      {
        "pattern_type": "character_insertion",
        "examples": [
          {"original": "react", "typosquat": "reaact"},
          {"original": "axios", "typosquat": "axioss"},
          {"original": "moment", "typosquat": "momentt"}
        ]
      },
      {
        "pattern_type": "character_deletion",
        "examples": [
          {"original": "webpack", "typosquat": "webpak"},
          {"original": "eslint", "typosquat": "eslnt"},
          {"original": "prettier", "typosquat": "pretier"}
        ]
      },
      {
        "pattern_type": "homoglyph_substitution",
        "examples": [
          {"original": "react", "typosquat": "rеact"},
          {"original": "lodash", "typosquat": "lоdash"},
          {"original": "express", "typosquat": "еxpress"}
        ]
      }
    ],
    "performance_benchmarks": {
      "single_package_analysis": {
        "target_time_ms": 500,
        "max_time_ms": 2000,
        "memory_limit_mb": 50
      },
      "batch_analysis": {
        "packages_per_second": 5,
        "concurrent_limit": 10,
        "memory_limit_mb": 200
      },
      "project_scanning": {
        "target_time_small_project_ms": 3000,
        "target_time_large_project_ms": 15000,
        "max_dependencies": 1000
      }
    },
    "integration_tests": [
      {
        "test_name": "npm_package_json_parsing",
        "description": "Test parsing of package.json with various dependency formats",
        "test_data": {
          "file_type": "package.json",
          "content": {
            "dependencies": {
              "lodash": "^4.17.21",
              "react": "~18.0.0",
              "express": ">=4.0.0",
              "axios": "latest"
            },
            "devDependencies": {
              "jest": "^29.0.0",
              "eslint": "^8.0.0"
            },
            "peerDependencies": {
              "react-dom": "^18.0.0"
            }
          }
        },
        "expected_packages": 6
      },
      {
        "test_name": "python_requirements_parsing", 
        "description": "Test parsing of requirements.txt with version specifiers",
        "test_data": {
          "file_type": "requirements.txt",
          "content": "requests==2.28.1\nnumpy>=1.20.0\nflask~=2.0.0\ndjango==4.1.*\npytest # dev dependency\n-e git+https://github.com/user/repo.git#egg=custom"
        },
        "expected_packages": 6
      },
      {
        "test_name": "go_mod_parsing",
        "description": "Test parsing of go.mod files", 
        "test_data": {
          "file_type": "go.mod",
          "content": "module example.com/myproject\n\ngo 1.21\n\nrequire (\n\tgithub.com/gin-gonic/gin v1.9.1\n\tgithub.com/stretchr/testify v1.8.4\n)\n\nrequire (\n\tgithub.com/bytedance/sonic v1.9.1 // indirect\n)"
        },
        "expected_packages": 3
      }
    ],
    "edge_cases": [
      {
        "case_name": "unicode_package_names",
        "description": "Packages with Unicode characters in names",
        "test_packages": [
          {"name": "tеst-pack", "registry": "npm", "note": "Cyrillic 'e'"},
          {"name": "tést-pack", "registry": "npm", "note": "Accented characters"}
        ]
      },
      {
        "case_name": "version_confusion",
        "description": "Packages with confusing version schemes",
        "test_packages": [
          {"name": "fake-package", "version": "999.999.999", "registry": "npm"},
          {"name": "version-spoof", "version": "1.0.0-really-malicious", "registry": "pypi"}
        ]
      },
      {
        "case_name": "namespace_confusion",
        "description": "Packages using similar namespaces",
        "test_packages": [
          {"name": "@types/lodash", "registry": "npm", "legitimate": true},
          {"name": "@type/lodash", "registry": "npm", "legitimate": false}
        ]
      }
    ]
  },
  "validation_criteria": {
    "detection_accuracy": {
      "high_risk_threats": {
        "minimum_detection_rate": 0.95,
        "acceptable_detection_rate": 0.90,
        "score_threshold": 0.8
      },
      "medium_risk_threats": {
        "minimum_detection_rate": 0.85,
        "acceptable_detection_rate": 0.75,
        "score_threshold": 0.6
      },
      "legitimate_packages": {
        "maximum_false_positive_rate": 0.05,
        "acceptable_false_positive_rate": 0.10,
        "score_threshold": 0.3
      }
    },
    "performance_requirements": {
      "response_time": {
        "single_package_p95": "2s",
        "single_package_p99": "5s",
        "batch_processing_per_package": "500ms"
      },
      "throughput": {
        "minimum_packages_per_second": 1,
        "target_packages_per_second": 5,
        "concurrent_requests": 10
      },
      "resource_usage": {
        "max_memory_per_analysis_mb": 100,
        "max_cpu_per_analysis_percent": 80,
        "max_network_bandwidth_mbps": 10
      }
    },
    "quality_metrics": {
      "code_coverage": {
        "minimum_overall": 0.80,
        "minimum_critical_components": 0.95
      },
      "api_reliability": {
        "uptime_requirement": 0.999,
        "error_rate_threshold": 0.01
      }
    }
  },
  "test_environments": {
    "local_development": {
      "description": "Local testing environment for development",
      "registry_mocks": true,
      "database": "sqlite",
      "cache": "memory",
      "parallelism": 2
    },
    "ci_testing": {
      "description": "Continuous integration testing environment",
      "registry_mocks": true,
      "database": "postgresql",
      "cache": "redis",
      "parallelism": 4,
      "timeout": "10m"
    },
    "staging": {
      "description": "Staging environment with real registries",
      "registry_mocks": false,
      "database": "postgresql",
      "cache": "redis",
      "parallelism": 8,
      "rate_limiting": true
    },
    "production_validation": {
      "description": "Production environment validation",
      "registry_mocks": false,
      "database": "postgresql_cluster",
      "cache": "redis_cluster", 
      "parallelism": 16,
      "monitoring": true,
      "alerting": true
    }
  }
}