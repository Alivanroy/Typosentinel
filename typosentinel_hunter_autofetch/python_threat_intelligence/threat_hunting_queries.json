{
  "splunk": [
    "index=* \"pip install\" (pandas2 OR pandas3 OR beautifulsoup OR django-dev OR flasks OR py-test)",
    "index=* sourcetype=python \"compile(\" | stats count by host",
    "index=* sourcetype=python \"getattr(\" \"op_\" | stats count by host",
    "index=* sourcetype=python \".aws\" \"secret\" | stats count by host"
  ],
  "elastic": [
    "process.command_line:(*pip* AND (*pandas2* OR *pandas3* OR *beautifulsoup* OR *django-dev*))",
    "file.path:*python* AND message:*compile*",
    "file.path:*python* AND message:*getattr* AND message:*op_*",
    "file.path:*python* AND message:*.aws* AND message:*secret*"
  ],
  "kql": [
    "DeviceProcessEvents | where ProcessCommandLine contains \"pip\" and (ProcessCommandLine contains \"pandas2\" or ProcessCommandLine contains \"pandas3\")",
    "DeviceFileEvents | where FileName endswith \".py\" and FileContent contains \"compile(\"",
    "DeviceNetworkEvents | where RemoteUrl contains \"pypi.org\" and RemoteUrl contains any(\"pandas2\", \"pandas3\", \"beautifulsoup\")"
  ]
}